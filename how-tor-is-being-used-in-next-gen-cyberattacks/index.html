<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>
   How Tor is Being Used in Next-Gen Cyberattacks. | MyIPNow
  </title>
<meta content="Learn about How Tor is Being Used in Next-Gen Cyberattacks. in this detailed guide on Online Safety." name="description"/>
<link href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;🌐&lt;/text&gt;&lt;text y=%22.9em%22 x=%2228%22 font-size=%2255%22&gt;📍&lt;/text&gt;&lt;/svg&gt;" rel="icon"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<style>
    body { font-family: 'Inter', sans-serif; background:#f7f8f9; margin:0; color:#1e293b; line-height:1.7; }
    .container { max-width:900px; margin:0 auto; padding:1rem; }
    .site-header { background:#fff; padding:1rem; margin-bottom:2rem; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.08); }
    .header-top { display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:1rem; padding-bottom:1rem; border-bottom:1px solid #e2e8f0; }
    .logo { font-size:1.5rem; font-weight:700; color:#1e293b; text-decoration:none; }
    .search-form { display:flex; flex-grow:1; max-width:400px; }
    .search-form input { width:100%; padding:0.75rem 1rem; border:1px solid #e2e8f0; border-radius:8px 0 0 8px; font-size:0.9rem; }
    .search-form button { padding:0.75rem 1rem; border:none; background:#10b981; color:white; border-radius:0 8px 8px 0; cursor:pointer; font-weight:500; }
    .category-nav { padding-top:1rem; }
    .category-nav ul {
  display:flex;
  gap:1.5rem;
  list-style:none;
  margin:0;
  padding:0;
  align-items:center;
  flex-wrap:wrap;
  justify-content:center !important;
}

.nav-tools { position: relative; }
.nav-tools > a { cursor: default; }
.nav-tools ul {
  display: none;
  position:absolute;
  top:100%;
  left:0;
  background:#fff;
  border:1px solid #e2e8f0;
  border-radius:8px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
  list-style:none;
  padding:.5rem 0;
  margin:0;
  min-width:220px;
  z-index:999;
}
.nav-tools ul li a {
  display:block;
  padding:.5rem 1rem;
  color:#1e293b;
  text-decoration:none;
}
.nav-tools ul li a:hover { color:#4f46e5; }
.nav-tools:hover ul { display:block; }


@media(max-width:768px){
  .category-nav ul {
    overflow-x:auto;
    white-space:nowrap;
    padding-bottom:10px;
  }

.nav-tools { position: relative; }
.nav-tools > a { cursor: default; }
.nav-tools ul {
  display: none;
  position:absolute;
  top:100%;
  left:0;
  background:#fff;
  border:1px solid #e2e8f0;
  border-radius:8px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
  list-style:none;
  padding:.5rem 0;
  margin:0;
  min-width:220px;
  z-index:999;
}
.nav-tools ul li a {
  display:block;
  padding:.5rem 1rem;
  color:#1e293b;
  text-decoration:none;
}
.nav-tools ul li a:hover { color:#4f46e5; }
.nav-tools:hover ul { display:block; }

}

.category-nav a {
  text-decoration: none;
  color: var(--text-primary);
  font-size: 0.9rem;
  font-weight: 500;
  transition: color var(--transition-speed);
}

.category-nav a:hover {
  color: var(--accent-color);
}
    .page-header { background:#fff; padding:2rem; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.08); margin-bottom:2rem; text-align:center; }
    .page-header h1 { font-size:2.2rem; margin:0 0 0.5rem; }
    .page-header p { font-size:1rem; color:#64748b; margin:0; }
    .article-body { background:#fff; padding:2rem; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.08); margin-bottom:2rem; }
    .article-body h2 { margin-top:2rem; font-size:1.5rem; }
    .article-body h3 { margin-top:1.2rem; font-size:1.2rem; }
    .related { background:#fff; padding:1.5rem; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.08); margin-bottom:2rem; }
    .related h3 { margin-top:0; }
    .related ul { list-style:none; padding:0; }
    .related li { margin-bottom:0.5rem; }
    .related a { text-decoration:none; color:#4f46e5; }
    .article-pagination { display:flex; justify-content:space-between; gap:1rem; margin-bottom:2rem; }
    .article-pagination a { background:#fff; padding:0.75rem 1rem; border-radius:8px; box-shadow:0 4px 10px rgba(0,0,0,0.05); text-decoration:none; color:#1e293b; font-weight:500; }
    .article-pagination a:hover { background:#4f46e5; color:white; }
    .footer { text-align:center; padding:2rem 1rem; margin:2rem auto 0; background:#fff; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.08); }
    .footer-nav { display:flex; justify-content:center; flex-wrap:wrap; gap:1rem 1.5rem; list-style:none; padding:0; margin:0 0 1rem; }
    .footer-nav a { color:#64748b; text-decoration:none; font-size:0.9rem; }
    .footer-nav a:hover { color:#4f46e5; }
    .footer-copyright { font-size:0.85rem; color:#64748b; }
   

.related-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 1rem;
}
.related-card {
  display: flex;
  flex-direction: column;
  background: #f9fafb;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  transition: transform 0.2s ease;
}
.related-card:hover {
  transform: translateY(-4px);
}
.related-card img {
  width: 100%;
  height: 140px;
  object-fit: cover;
}
.related-card-content {
  padding: 1rem;
}
.related-card-content h4 {
  margin: 0 0 0.5rem;
  font-size: 1rem;
}
.related-card-content p {
  font-size: 0.9rem;
  color: #64748b;
  margin: 0;
}
.related-card-content a {
  text-decoration: none;
  color: #4f46e5;
  font-weight: 600;
}
.related-card-content a:hover {
  color: #1e293b;
}
</style>
<style>
.nav {
  text-align: center !important;
}
.nav li {
  display: inline-block !important;
  float: none !important;
}
</style>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1226342433058379"></script>
<link href="https://myipnow.net/how-tor-is-being-used-in-next-gen-cyberattacks/" rel="canonical"/><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://myipnow.net/#website","url":"https://myipnow.net/","name":"MyIPNow"},{"@type":"Organization","@id":"https://myipnow.net/#organization","name":"MyIPNow","url":"https://myipnow.net/"},{"@type":"WebPage","@id":"https://myipnow.net/how-tor-is-being-used-in-next-gen-cyberattacks/","url":"https://myipnow.net/how-tor-is-being-used-in-next-gen-cyberattacks/","name":"How Tor is Being Used in Next-Gen Cyberattacks. | MyIPNow","description":"Learn about How Tor is Being Used in Next-Gen Cyberattacks. in this detailed guide on Online Safety.","isPartOf":{"@id":"https://myipnow.net/#website"},"keywords":"my ip, what is my ip, ip lookup, ip address lookup, free ip lookup tool, ipv4, ipv6, ipv6 lookup, ip geolocation, ip location, check ip, ip tools, public ip, website ip lookup, dns checker ip location, ip proxy checker, whatismyipaddress.com, whatsmyip, whatismyip, networking, privacy, security, myipnow, whatis my ip address, IP address tracker, check IP address, best IP lookup 2025, WhatIsMyIPAddress alternative, online IP checker, internet privacy, network security, online ip lookup tool, ip geolocation tool, website ip checker, website ip address lookup, ip address lookup tool, ip look up tool, ip address search tool, search ip tool, ipv6 ip lookup"},{"@type":"Article","@id":"https://myipnow.net/how-tor-is-being-used-in-next-gen-cyberattacks/#article","headline":"How Tor is Being Used in Next-Gen Cyberattacks.","description":"Learn about How Tor is Being Used in Next-Gen Cyberattacks. in this detailed guide on Online Safety.","mainEntityOfPage":"https://myipnow.net/how-tor-is-being-used-in-next-gen-cyberattacks/","isPartOf":{"@id":"https://myipnow.net/#website"},"author":{"@type":"Organization","name":"MyIPNow"},"publisher":{"@id":"https://myipnow.net/#organization"},"datePublished":"2025-09-22","dateModified":"2025-09-22","keywords":"my ip, what is my ip, ip lookup, ip address lookup, free ip lookup tool, ipv4, ipv6, ipv6 lookup, ip geolocation, ip location, check ip, ip tools, public ip, website ip lookup, dns checker ip location, ip proxy checker, whatismyipaddress.com, whatsmyip, whatismyip, networking, privacy, security, myipnow, whatis my ip address, IP address tracker, check IP address, best IP lookup 2025, WhatIsMyIPAddress alternative, online IP checker, internet privacy, network security, online ip lookup tool, ip geolocation tool, website ip checker, website ip address lookup, ip address lookup tool, ip look up tool, ip address search tool, search ip tool, ipv6 ip lookup","url":"https://myipnow.net/how-tor-is-being-used-in-next-gen-cyberattacks/"}]}</script><style>
@media (max-width: 768px) {
  .category-nav {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
    padding-bottom: 10px;
  }
  .category-nav ul {
    display: inline-flex;
    flex-wrap: nowrap;
    white-space: nowrap;
    gap: 1.2rem;
    list-style: none;
    margin: 0;
    padding: 0 1rem;
  }
  .category-nav::-webkit-scrollbar { height: 6px; }
  .category-nav::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 4px;
  }
  .nav-tools ul {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: auto;
    background: #fff;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    list-style: none;
    padding: .5rem 0;
    margin: 0;
    min-width: 220px;
    z-index: 999;
  }
  .nav-tools.open ul { display: block; }
}
</style>



<style>
@media (max-width: 768px) {
  .nav-tools {
    position: static !important;
  }
  .nav-tools ul {
    position: fixed !important;
    top: 60px !important;
    left: 10px;
    right: 10px;
    display: none;
    background: #fff;
    border: 1px solid #e2e8f0;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    z-index: 10000;
  }
  .nav-tools.open ul {
    display: block !important;
  }
  body.menu-open {
    overflow: hidden;
  }
}
</style>



</head>
<body>
<script async crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1226342433058379"></script>

<div class="container"><header class="site-header">
<div class="header-top">
<a class="logo" href="/index.html">🌐 MyIPNow</a>
<form action="/search.html" class="search-form" method="get">
<input aria-label="Search articles" name="q" placeholder="Search..." type="search"/>
<button type="submit">Search</button>
</form>
</div>
<nav aria-label="Article Categories" class="category-nav">
<ul>
<li class="nav-tools"><a href="#">Tools ▾</a>
<ul>
<li><a href="/index.html">IP Lookup</a></li>
<li><a href="/dns-lookup.html">DNS Lookup</a></li>
<li><a href="/whois-lookup.html">WHOIS Lookup</a></li>
<li><a href="/internet-speed-test.html">Internet Speed Test</a></li>
<li><a href="/generate-password.html">Generate Password</a></li>
<li><a href="/ip-blacklist.html">IP Blacklist</a></li>
</ul>
</li>
<li><a href="/online-safety/index.html">Online Safety</a></li>
<li><a href="/online-privacy/index.html">Online Privacy</a></li>
<li><a href="/networking/index.html">Networking</a></li>
<li><a href="/ip-addresses/index.html">IP Addresses</a></li>
<li><a href="/home-computing/index.html">Home Computing</a></li>
<li><a href="/general-topics/index.html">General Topics</a></li>
</ul>
</nav>
</header>
<!-- Header -->
<!-- Page Header --><!-- Article Body -->
<header class="page-header">
<h1>How Tor is Being Used in Next-Gen Cyberattacks.</h1>
</header>
<article class="article-body"><p class="article-meta">🗓️ Published on September 22, 2025</p>
<h2>
     How Tor is Being Used in Next-Gen Cyberattacks
    </h2>
<p>
     The landscape of cybercrime is constantly evolving, with cybercriminals employing increasingly sophisticated techniques to carry out their activities. Among these techniques is the use of the Tor network, which provides anonymity and privacy to its users. While Tor was initially designed to protect user privacy, it has also become a tool for malicious actors. In this article, we'll explore how Tor is being exploited in next-gen cyberattacks, the implications for online safety, and what measures can be taken to mitigate these risks. </p>
<h2>
     Understanding Tor: The Basics
    </h2>
<p>
     Before delving into its misuse, it is important to understand what Tor is and how it functions. </p>
<h3>
     What is Tor?
    </h3>
<p>
     Tor, short for "The Onion Router," is a free software that enables anonymous communication over the internet. It achieves this by routing internet traffic through a network of volunteer-operated servers (called nodes or relays), which obfuscates the user's IP address and location. This multi-layered approach to data transmission provides users with enhanced privacy. </p>
<h3>
     How Does Tor Work?
    </h3>
<ul>
<li>
<strong>
       Entry Node:
      </strong>
      The user's data enters the Tor network through an entry node, which encrypts the data.
     </li>
<li>
<strong>
       Middle Nodes:
      </strong>
      The data is then passed through several middle nodes, each adding another layer of encryption.
     </li>
<li>
<strong>
       Exit Node:
      </strong>
      Finally, the data exits through an exit node, where it is decrypted and sent to its final destination. The exit node is the only part of the Tor network that can see the unencrypted data.
     </li>
</ul>
<h2>
     The Dark Side of Tor: How Cybercriminals are Utilizing It
    </h2>
<p>While Tor provides significant benefits for legitimate users seeking privacy, it has also attracted cybercriminals who take advantage of its anonymity. Below are some of the ways Tor is being used in next-gen cyberattacks. </p>
<h3>
     1. Ransomware Distribution
    </h3>
<p>Ransomware attacks, where hackers encrypt a victim's files and demand a ransom for access, have become increasingly common. Tor is often used to facilitate these attacks in the following ways:
    </p>
<ul>
<li>
<strong>
       Anonymity:
      </strong>
      Cybercriminals use Tor to mask their identities, making it difficult for law enforcement to track them down.
     </li>
<li>
<strong>
       Payment Systems:
      </strong>
      Many ransomware operators require payments in cryptocurrencies, which are often laundered through the Tor network, adding another layer of anonymity.
     </li>
</ul>
<h3>
     2. Phishing Attacks
    </h3>
<p>
     Phishing is another area where Tor is leveraged by cybercriminals. By using Tor, attackers can create deceptive websites that appear legitimate but are designed to harvest sensitive information. This is particularly concerning for:
    </p>
<ul>
<li>
<strong>
       Credential Harvesting:
      </strong>
      Fake login pages can be hosted on Tor, making it difficult to trace back to the original source.
     </li>
<li>
<strong>
       Targeting High-Profile Individuals:
      </strong>
      Tor can be used to create targeted phishing campaigns against individuals in sensitive positions, such as government officials or corporate executives.
     </li>
</ul>
<h3>
     3. Hosting Illegal Marketplaces
    </h3>
<p>Tor is well-known for hosting illegal marketplaces where illicit goods and services are traded, including drugs, weapons, and stolen data. These marketplaces are often difficult to shut down due to the anonymity provided by the network. Key points include:
    </p>
<ul>
<li>
<strong>
       Decentralization:
      </strong>
      Many of these marketplaces are decentralized, making them resilient to law enforcement efforts.
     </li>
<li>
<strong>
       Escrow Services:
      </strong>
      Transactions are often secured through escrow services that operate within the Tor network, further complicating traceability.
     </li>
</ul>
<h3>
     4. Botnet Command and Control
    </h3>
<p>
     Cybercriminals often use Tor to communicate with botnets—networks of compromised computers used to launch distributed denial-of-service (DDoS) attacks or spread malware. Tor allows these communications to remain hidden, which poses challenges for cybersecurity teams trying to dismantle these networks. </p>
<h2>
     Implications for Online Safety
    </h2>
<p>
     The misuse of Tor for cyberattacks raises significant concerns for online safety, impacting both individuals and organizations. Here are some implications to consider:</p>
<h3>
     1. Increased Risk of Cyberattacks
    </h3>
<p>As the use of Tor becomes more prevalent in cybercrime, the risk of attacks on individuals and organizations is heightened. Businesses, in particular, must be vigilant in their cybersecurity practices to avoid falling victim to ransomware and phishing schemes. </p>
<h3>
     2. Challenges for Law Enforcement
    </h3>
<p>
     The anonymity provided by Tor complicates law enforcement's ability to investigate and prosecute cybercriminals. Traditional methods of tracking and tracing online activities become less effective, necessitating the development of new strategies and technologies. </p>
<h3>
     3. Erosion of Trust
    </h3>
<p>
     As attacks utilizing Tor become more common, public trust in online platforms and services may erode. Individuals may become wary of using certain services, fearing that their personal information could be compromised. </p>
<h2>
     Mitigation Strategies for Individuals and Organizations
    </h2>
<p>While the challenges posed by the misuse of Tor are significant, there are several strategies that individuals and organizations can implement to mitigate risks:</p>
<h3>
     1. Educating Users
    </h3>
<p>
     Education is a powerful tool in combating cybercrime. Organizations should invest in cybersecurity training for employees to recognize phishing attempts and understand safe online practices. Regular training sessions can help keep security top-of-mind. </p>
<h3>
     2. Implementing Strong Security Protocols
    </h3>
<p>Organizations should adopt robust security measures, including:</p>
<ul>
<li>
<strong>
       Firewalls:
      </strong>
      Use advanced firewalls to monitor incoming and outgoing traffic.
     </li>
<li>
<strong>
       Intrusion Detection Systems:
      </strong>
      Employ IDS solutions to detect and respond to suspicious activities.
     </li>
<li>
<strong>
       Regular Software Updates:
      </strong>
      Keep all software, including antivirus programs, up to date to protect against known vulnerabilities.
     </li>
</ul>
<h3>
     3. Multi-Factor Authentication (MFA)
    </h3>
<p>Implementing MFA can significantly reduce the risk of unauthorized access to sensitive accounts. This adds an additional layer of security, making it more difficult for cybercriminals to gain access even if they obtain a user's credentials. </p>
<h3>
     4. Incident Response Plans
    </h3>
<p>Organizations should develop and regularly update incident response plans to ensure swift action in the event of a cyberattack. This includes identifying the roles and responsibilities of team members, establishing communication protocols, and conducting regular drills. </p>
<h2>
     Conclusion
    </h2>
<p>
     The use of Tor in next-gen cyberattacks poses significant challenges for online safety, affecting individuals and organizations alike. While Tor offers genuine benefits for privacy and anonymity, its exploitation by cybercriminals cannot be overlooked. By understanding the risks associated with Tor and implementing robust security measures, individuals and organizations can better protect themselves against the evolving threat landscape. Cybersecurity is an ongoing battle, and staying informed is key to staying safe in an increasingly digital world. </p>
<div class="references"><p>References:</p><ul><li><a href="https://staysafeonline.org/" rel="noopener noreferrer" target="_blank">StaySafeOnline.org (NCA)</a></li><li><a href="https://safety.google/" rel="noopener noreferrer" target="_blank">Google Safety Center</a></li><li><a href="https://www.microsoft.com/en-us/safety/family-online-safety" rel="noopener noreferrer" target="_blank">Microsoft Online Safety</a></li><li><a href="https://www.cisa.gov/topics/cybersecurity" rel="noopener noreferrer" target="_blank">CISA – Cybersecurity Resources</a></li><li><a href="https://us.norton.com/blog" rel="noopener noreferrer" target="_blank">Norton Cyber Safety Blog</a></li></ul></div><section class="see-also"><h2>See Also</h2><ul><li><a href="/beyond-artificial-intelligence-cybersecurity-what-comes-next-in-digital-security/">Beyond Artificial Intelligence Cybersecurity: What Comes Next in Digital Security? | MyIPNow</a></li><li><a href="/reverse-dns/">Reverse dns – Free IP Lookup &amp; Guide | MyIPNow</a></li><li><a href="/unlocking-the-power-of-digital-arrest-scam-expert-tips-and-tricks/">Unlocking the Power of Digital Arrest Scam: Expert Tips and Tricks. | MyIPNow</a></li><li><a href="/the-impact-of-ai-on-captcha-a-2025-forecast/">The Impact of AI on Captcha: A 2025 Forecast. | MyIPNow</a></li><li><a href="/mastering-virtual-kidnapping-the-ultimate-2025-deep-dive/">Mastering Virtual Kidnapping: The Ultimate 2025 Deep Dive. | MyIPNow</a></li></ul></section><p class="updated-date">Last updated: November 1, 2025</p></article><!-- Pagination (Next / Prev / Back) --><!-- Related Articles --><!-- Pagination (Next / Prev / Back) --><!-- Related Articles --><div class="article-pagination" style="display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:1rem;"><a href="/how-times-people-thought-is-being-used-in-next-gen-cyberattacks/" style="justify-self:start;">← Previous Article</a><a href="/online-safety/page21.html" id="returnToCategory" style="justify-self:center;">↑ Return to Category</a><a href="/how-turn-enhanced-safe-is-being-used-in-next-gen-cyberattacks/" style="justify-self:end;">Next Article →</a></div><footer class="footer">
<ul class="footer-nav">
<li>
<a href="/about.html">
       About
      </a>
</li>
<li>
<a href="/contact.html">
       Contact
      </a>
</li>
<li>
<a href="/privacy-policy.html">
       Privacy Policy
      </a>
</li>
<li>
<a href="/terms-of-use.html">
       Terms of Use
      </a>
</li>
<li>
<a href="/affiliate-disclosure.html">
       Affiliate Disclosure
      </a>
</li>
</ul>
<div class="footer-copyright">
     © 2025 MyIPNow. All Rights Reserved.
    </div>
</footer><!-- Related Articles --></div>
<script id="article-return-v3">
(function(){
  var KEY='catStateV3'; // { url, scroll }
  var CAT_RE=/^\/(online-safety|online-privacy|networking|ip-addresses|home-computing|general-topics)\//;

  function init(){
    var btn = document.getElementById('returnToCategory');
    if (!btn) return;

    var raw = null, url=null;
    try {
      raw = sessionStorage.getItem(KEY);
      if (raw){
        var st = JSON.parse(raw);
        url = st && st.url;
      }
    } catch(e){}

    // If we have a stored category URL, use it
    if (url && CAT_RE.test(url)) {
      btn.setAttribute('href', url);
      return;
    }

    // Fallback: deduce category from article path and use /<cat>/index.html
    var parts = location.pathname.split('/').filter(Boolean);
    if (parts.length > 0) {
      var cat = '/' + parts[0] + '/';
      if (CAT_RE.test(cat)) {
        btn.setAttribute('href', cat + 'index.html');
      }
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>

























<script id="mobile-header-fix-final">
(function(){
  const tools = document.querySelector('.nav-tools');
  if(!tools) return;
  const trigger = tools.querySelector(':scope > a');
  const dropdown = tools.querySelector(':scope > ul');
  if(!trigger || !dropdown) return;

  let menu=null, backdrop=null, open=false;

  // Desktop hover
  tools.addEventListener('mouseenter',()=>{ if(window.innerWidth>768) dropdown.style.display='block'; });
  tools.addEventListener('mouseleave',()=>{ if(window.innerWidth>768) dropdown.style.display='none'; });

  function closeMenu(){
    if(menu){ menu.remove(); menu=null; }
    if(backdrop){ backdrop.remove(); backdrop=null; }
    dropdown.style.display='none';
    document.body.classList.remove('menu-open');
    open=false;
  }

  function openMenu(e){
    e.preventDefault(); e.stopPropagation();
    if(window.innerWidth>768) return;

    dropdown.style.display='none'; // hide original header dropdown

    if(open){ closeMenu(); return; }

    const rect = trigger.getBoundingClientRect();
    backdrop = document.createElement('div');
    Object.assign(backdrop.style,{
      position:'fixed',top:0,left:0,width:'100vw',height:'100vh',
      background:'transparent',zIndex:9998
    });
    backdrop.addEventListener('click', closeMenu);
    document.body.appendChild(backdrop);

    menu = dropdown.cloneNode(true);
    Object.assign(menu.style,{
      position:'absolute',
      top:`${rect.bottom + window.scrollY + 8}px`,
      left:`${rect.left + window.scrollX}px`,
      minWidth:`${Math.max(rect.width,200)}px`,
      background:'#fff',
      border:'1px solid #e2e8f0',
      borderRadius:'10px',
      boxShadow:'0 10px 30px rgba(0,0,0,0.15)',
      listStyle:'none',
      padding:'.5rem 0',
      margin:0,
      zIndex:9999,
      maxHeight:'70vh',
      overflowY:'auto',
      display:'block',        /* ✅ ensures visible */
      visibility:'visible',   /* ✅ fixes Safari hover ghost */
      opacity:'1'             /* ✅ fully visible */
    });
    menu.querySelectorAll('a').forEach(a=>{
      a.style.display='block';
      a.style.padding='.6rem 1.2rem';
      a.style.color='#1e293b';
      a.style.textDecoration='none';
      a.style.fontWeight='500';
      a.addEventListener('mouseenter',()=>a.style.color='#4f46e5');
      a.addEventListener('mouseleave',()=>a.style.color='#1e293b');
    });

    document.body.appendChild(menu);
    document.body.classList.add('menu-open');
    open=true;
  }

  window.addEventListener('scroll',()=>{ if(!open||!menu)return;
    const rect=trigger.getBoundingClientRect();
    menu.style.top=`${rect.bottom + window.scrollY + 8}px`;
    menu.style.left=`${rect.left + window.scrollX}px`;
  });
  window.addEventListener('resize',closeMenu);
  trigger.addEventListener('click',openMenu);
  trigger.addEventListener('touchstart',openMenu,{passive:false});
})();
</script>
</body>
</html>